!function(t){function e(e){for(var a,l,c=e[0],o=e[1],r=e[2],f=0,h=[];f<c.length;f++)l=c[f],Object.prototype.hasOwnProperty.call(n,l)&&n[l]&&h.push(n[l][0]),n[l]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a]);for(u&&u(e);h.length;)h.shift()();return i.push.apply(i,r||[]),s()}function s(){for(var t,e=0;e<i.length;e++){for(var s=i[e],a=!0,c=1;c<s.length;c++){var o=s[c];0!==n[o]&&(a=!1)}a&&(i.splice(e--,1),t=l(l.s=s[0]))}return t}var a={},n={21:0},i=[];function l(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,l),s.l=!0,s.exports}l.m=t,l.c=a,l.d=function(t,e,s){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},l.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(l.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)l.d(s,a,function(e){return t[e]}.bind(null,a));return s},l.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="";var c=window.webpackJsonp=window.webpackJsonp||[],o=c.push.bind(c);c.push=e,c=c.slice();for(var r=0;r<c.length;r++)e(c[r]);var u=o;i.push([19,1,0]),s()}({1035:function(t,e,s){"use strict";var a=s("bced");s.n(a).a},19:function(t,e,s){t.exports=s("e613")},"48f8":function(t,e,s){"use strict";var a=s("f64f");s.n(a).a},a5a3:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAABUUlEQVQokY2TPUsDQRCGnwtioRZ+K9hpZaOCgprWiCZgq6eQP2BnmsD1prC0spUUp/4D4SohakCLFDZqBMVC84ESMKAmnozZu2hMLnnhYHdmnp25nR3Ntm0cBWL4gDVgHZgDBoAscA6YwKFl8OXEu3AgxihwBEzTWJfAqmVw58IKPAMGPUBHGWBeDtAWtm0pNQnMeBHjI3Cfg+L7z/YCmBVQbwb2dsHmIpTKrknidYHDzercCsKeBR+lP+awr1nW0FSl3KvHf65Jgftl1dMJkRB0tFe9w92wNAH7J3XP7RM4J6uXN0jews4GjA2BpkEkCLvH8FmuC+fb1M0tyy5xDTdPEF2B1yKkHiD93PCPUpI5/tuSKUDUhGwBzFOv2yDecp9rVOmzeqvSa3k5rUjidOEkK5ZBGvCrt+sl8ftVfHUwRDVTJQMibcyrMg/kc6cK+AYj9GpDTmN/XgAAAABJRU5ErkJggg=="},bced:function(t,e,s){},e613:function(t,e,s){"use strict";s.r(e),s("cadf"),s("551c"),s("f751"),s("097d");var a=s("22b4"),n=(s("96cf"),s("1da1")),i=(s("20d6"),s("7f7f"),s("ac6a"),s("b681")),l=s("1aa9"),c=(s("c5f6"),s("82ea")),o=s("b3cb"),r={props:{params:{type:Object,default:function(){return{}}},totalNum:{type:Number,default:0},notYet:{type:Number,default:0}},components:{BaseButton:c.a},data:function(){return{show:!0}},created:function(){},methods:{submit:function(){var t=this;Object(o.g)(this.params).then((function(e){e.success&&(api.toast({msg:"点名成功",global:!0}),t.close(1))}))},close:function(t){this.$emit("close",t)}}},u=(s("1035"),s("2877")),f=Object(u.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-popup",{on:{close:t.close},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("img",{attrs:{src:s("e6ff"),alt:""}}),a("div",{staticClass:"content "},[a("div",{staticClass:"title"},[t._v("本次点名共"),a("span",{staticClass:"blue"},[t._v(t._s(t.totalNum))]),t._v("人,缺勤"),a("span",{staticClass:"red"},[t._v(t._s(t.notYet))]),t._v("人")]),a("div",{staticClass:"btn-wrap"},[a("div",{staticClass:"confirm",on:{click:t.submit}},[t._v("确认点名")]),a("div",{staticClass:"cancel",on:{click:function(e){t.show=!1}}},[t._v("取消点名")])])])])}),[],!1,null,"f84489fe",null).exports,h=s("c1df"),d=s.n(h),p=s("4505"),v=s("5780"),m={components:{headerBetween:i.a,BaseDropdown:l.a,confirm:f},data:function(){return{dropdown:[{text:"全部商品",value:2},{text:"新款商品",value:1}],allSelect:!1,dialog:!1,dateVisible:!1,hoursVisible:!1,rollCallVisible:!1,minDate:new Date,maxDate:new Date,currentDate:null,page:1,className:"",preHours:"",classId:"",photo:"",refType:"上课",refTypeAction:[{name:"上课",value:"OrgClass"},{name:"补课",value:"MakeUp"}],dateInfo:{year:null,month:null,day:null},dateType:"",totalNum:0,notYet:0,classVisible:!1,classList:[],studentList:[],params:{}}},created:function(){this.currentDate=new Date,this.getClassList()},watch:{classId:function(){"上课"==this.refType?this.getStudentList():this.getMakeUpStudentList()},currentDate:function(t){this.dateInfo.year=this.currentDate.getFullYear(),this.dateInfo.month=this.currentDate.getMonth()+1,this.dateInfo.day=this.currentDate.getDate();var e=this.dateInfo,s=e.year,a=e.month,n=e.day;this.dateType="".concat(s,"年").concat(a,"月").concat(n,"日")},refType:function(t){"上课"==t?this.getClassList():this.getMakeUpClassList()}},methods:{getClassList:function(){var t=this;Object(o.a)({page:this.page,pageSize:10}).then((function(e){e.value.data.forEach((function(t){t.name=t.className})),t.classList=e.value.data,e.value.data.length&&(t.classId=t.classList[0].id,t.className=t.classList[0].className,t.preHours=t.classList[0].courseHours)}))},getStudentList:function(){var t=this;Object(o.d)({classId:this.classId}).then((function(e){e.value&&e.value.length?(e.value.forEach((function(t){t.isCheck=!1})),t.studentList=e.value):t.studentList=[]}))},getMakeUpClassList:function(){var t=this;Object(o.b)().then((function(e){t.classList=e.value,e.value.length?(t.classId=e.value[0].id,t.className=e.value[0].name,t.preHours=e.value[0].makeupHour):(t.classId="",t.className="暂无需要补课的班级",t.preHours="0")}))},getMakeUpStudentList:function(){var t=this;Object(o.c)({makeUpId:this.classId}).then((function(e){e.value&&e.value.length?(e.value.forEach((function(t){t.isCheck=!1})),t.studentList=e.value):t.studentList=[]}))},allClick:function(){var t=this.allSelect;this.studentList.forEach((function(e){e.isCheck=!t})),this.allSelect=!t},selectClick:function(t){t.isCheck=!t.isCheck,t.isCheck?-1===this.studentList.findIndex((function(t){return!t.isCheck}))&&(this.allSelect=!0):this.allSelect=!1},showActionSheet:function(t){this[t]=!0},onClassSelect:function(t){this.preHours=t.courseHours,this.className=t.name,this.classId=t.id,this.classVisible=!1},onRollCallSelect:function(t){this.refType=t.name,this.rollCallVisible=!1},onDateConfirm:function(t){this.dateVisible=!1},onDateCancel:function(){this.dateVisible=!1},formatter:function(t,e){return"year"===t?"".concat(e,"年"):"month"===t?"".concat(e,"月"):e},upload:function(){var t=Object(n.a)(regeneratorRuntime.mark((function t(){var e,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$checkSystemAccess("camera","相机");case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,this.$getCamera();case 7:return e=t.sent,t.next=10,this.$fileUpload(e.data);case 10:(s=t.sent).success&&(this.photo=s.hostPath[0]);case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),btnClick:function(){var t=this.classId,e=this.refType,s=this.currentDate,a=this.preHours,n=this.photo,i=this.dateInfo,l=this.studentList,c={};c.refId=t,c.refType="上课"==e||"OrgClass"==e?"OrgClass":"MakeUp",c.courseDate=d()(s).format("YYYY-MM-DD"),c.preHours=a,c.photo=n,c.year=i.year,c.month=i.month;var o=l.filter((function(t){if(t.isCheck)return t.id}));return c.studentId=o.map((function(t){return t.id})),c.photo?c.preHours?c.studentId.length<=0?this.$toast.fail("请选择学生"):(this.params=c,this.totalNum=l.length,this.notYet=this.totalNum-o.length,void(this.dialog=!0)):this.$toast.fail("请输入课时"):this.$toast.fail("请拍摄合影")},rightClick:function(){Object(p.b)(v.u)},close:function(t){t&&(this.photo="",this.allSelect=!1,this.rightClick(),"上课"==this.refType?this.getClassList():this.getMakeUpClassList()),this.dialog=!1}}},b=(s("48f8"),Object(u.a)(m,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("headerBetween",{attrs:{leftText:"点名",leftType:!0,bgColor:"#fff",rightText:"点名记录"},on:{rightClick:t.rightClick}}),a("div",{staticClass:"content"},[a("div",{staticClass:"photo flex",on:{click:t.upload}},[t.photo?a("img",{attrs:{src:t.photo,alt:""}}):a("div",{staticClass:"img-frame"},[a("span",[t._v("点击拍摄合影")])])]),a("div",{staticClass:"card"},[a("van-cell",{attrs:{title:"点名类型","is-link":"",value:t.refType},on:{click:function(e){return t.showActionSheet("rollCallVisible")}}}),a("van-action-sheet",{attrs:{description:"请选择点名类型",className:"class-action",actions:t.refTypeAction},on:{select:t.onRollCallSelect},model:{value:t.rollCallVisible,callback:function(e){t.rollCallVisible=e},expression:"rollCallVisible"}}),a("van-cell",{attrs:{title:"班级","is-link":"",value:t.className},on:{click:function(e){return t.showActionSheet("classVisible")}}}),a("van-action-sheet",{attrs:{description:"请选择班级",className:"class-action",actions:t.classList},on:{select:t.onClassSelect},model:{value:t.classVisible,callback:function(e){t.classVisible=e},expression:"classVisible"}}),a("van-cell",{attrs:{title:"日期","is-link":"",value:t.dateType},on:{click:function(e){return t.showActionSheet("dateVisible")}}}),a("van-popup",{style:{height:"30%"},attrs:{round:"",position:"bottom"},model:{value:t.dateVisible,callback:function(e){t.dateVisible=e},expression:"dateVisible"}},[a("van-datetime-picker",{attrs:{type:"date",title:"选择日期","max-date":t.maxDate},on:{confirm:t.onDateConfirm,cancel:t.onDateCancel},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1),a("van-field",{attrs:{label:"课时",readonly:"",clearable:"",placeholder:"请输入课时","input-align":"right"},model:{value:t.preHours,callback:function(e){t.preHours=e},expression:"preHours"}})],1),a("div",{staticClass:"name-list"},[a("div",{staticClass:"title flex"},[a("div",{staticClass:"name"},[t._v("学生名单")]),a("van-radio",{on:{click:t.allClick},scopedSlots:t._u([{key:"icon",fn:function(e){return[a("div",{staticClass:"icon flex"},[t.allSelect?a("div",{staticClass:"round"}):t._e()])]}}])},[a("div",{class:{label:t.allSelect}},[t._v("选择全部")])])],1),t.studentList.length?a("div",{staticClass:"list "},t._l(t.studentList,(function(e){return a("div",{key:e.id,staticClass:"list-item",on:{click:function(s){return t.selectClick(e)}}},[a("img",{staticClass:"icon student-img",attrs:{src:e.hostHeader,alt:""}}),a("div",{staticClass:"name"},[t._v(t._s(e.name))]),e.isCheck?a("img",{staticClass:"select",attrs:{src:s("a5a3"),alt:""}}):t._e()])})),0):a("div",{staticClass:"no-list"},[t._v("\n        暂无学生名单\n      ")])])]),a("div",{staticClass:"btn",on:{click:t.btnClick}},[t._v("点名")]),t.dialog?a("confirm",{attrs:{params:t.params,totalNum:t.totalNum,notYet:t.notYet},on:{close:t.close}}):t._e()],1)}),[],!1,null,"47118ddc",null).exports);new a.a({el:"#app",render:function(t){return t(b)}})},e6ff:function(t,e,s){t.exports=s.p+"img/confirm-bg.735f2ead.png"},f64f:function(t,e,s){}});